<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="pyspider爬取并解析网页中table数据的例子" /><meta property="og:locale" content="en" /><meta name="description" content="python" /><meta property="og:description" content="python" /><link rel="canonical" href="/posts/pyspider_table/" /><meta property="og:url" content="/posts/pyspider_table/" /><meta property="og:site_name" content="Chirpy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-09-25T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="pyspider爬取并解析网页中table数据的例子" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2018-09-25T00:00:00+00:00","datePublished":"2018-09-25T00:00:00+00:00","description":"python","headline":"pyspider爬取并解析网页中table数据的例子","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/pyspider_table/"},"url":"/posts/pyspider_table/"}</script><title>pyspider爬取并解析网页中table数据的例子 | Chirpy</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Chirpy"><meta name="application-name" content="Chirpy"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Chirpy</a></div><div class="site-subtitle font-italic">A text-focused Jekyll theme</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/github_username" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>pyspider爬取并解析网页中table数据的例子</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>pyspider爬取并解析网页中table数据的例子</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1537833600" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 25, 2018 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">your_full_name</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3051 words"> <em>16 min</em> read</span></div></div></div><div class="post-content"><p>主要爬取一些第三方接口参数，字段，说明信息，有很多个下面这种类似的页面，这些都是table数据</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
</pre><td class="rouge-code"><pre>&lt;table class="confluenceTable"&gt;
    &lt;colgroup&gt;
     &lt;col style="width: 130.0px;" /&gt;
     &lt;col style="width: 77.0px;" /&gt;
     &lt;col style="width: 384.0px;" /&gt;
    &lt;/colgroup&gt;
    &lt;tbody&gt;
     &lt;tr&gt;
      &lt;th class="confluenceTh"&gt;参数&lt;/th&gt;
      &lt;th class="confluenceTh"&gt;是否必填&lt;/th&gt;
      &lt;th class="confluenceTh"&gt;说明&lt;/th&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td class="confluenceTd"&gt;appid&lt;/td&gt;
      &lt;td class="confluenceTd"&gt;Y&lt;/td&gt;
      &lt;td class="confluenceTd"&gt;&lt;br /&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td class="confluenceTd"&gt;&lt;span&gt;idNo&lt;/span&gt;&lt;/td&gt;
      &lt;td class="confluenceTd"&gt;Y&lt;/td&gt;
      &lt;td class="confluenceTd"&gt;&lt;span&gt;证件号码&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td class="confluenceTd"&gt;&lt;span&gt;name&lt;/span&gt;&lt;/td&gt;
      &lt;td class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
      &lt;td class="confluenceTd"&gt;&lt;span&gt;姓名&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;photoStr&lt;/span&gt;&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;照片文件&lt;/span&gt;&lt;br /&gt;&lt;span&gt;注意：原始图片不能超过 2M，且必须为 JPG 或 PNG 格式&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;sourcePhotoStr&lt;/span&gt;&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;合作伙伴自己提供的可信比对源照片&lt;/span&gt;&lt;br /&gt;&lt;span&gt;注意：原始图片不能超过 2M，且必须为 JPG 或 PNG 格式&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;sourcePhotoType&lt;/span&gt;&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;比对源照片类型&lt;/span&gt;&lt;br /&gt;&lt;span&gt;1：网纹照&lt;/span&gt;&lt;br /&gt;&lt;span&gt;2：高清照&lt;/span&gt;&lt;/td&gt;
     &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;transationid&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;Y&lt;/td&gt;
      &lt;td colspan="1" class="confluenceTd"&gt;每次请求唯一的标识（和第三方接口中的orderno对应）&lt;/td&gt;
     &lt;/tr&gt;
    &lt;/tbody&gt;
   &lt;/table&gt;
</pre></table></code></div></div><p>原本用pyspider的response应该就可以了，response.doc返回的本来就是PyQuery，于是遍历所有tr,然后遍历tr内的td获取text就好了， <br /> 发现 1)有的td内部有span标签的会获取不到数据,2) 有很多td的text本来就是空的，二期也没有表头，不能直接用doc获取整个页面的td计算， 也想过直接用etree,lxml.html <br /> 没招了，只好试一试BeautifulSoup</p><p>详细代码</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>from bs4 import BeautifulSoup
from lxml.html import etree
import lxml.html
for item in response.doc('.confluenceTable').items():
    table_header_dict={}
    root = lxml.html.fromstring(item.html())
    soup = BeautifulSoup(item.html())
    for row in soup.findAll("tr"):
        # 获取tr内的th,得到表头信息
        th_cells = row.find_all("th")
        if len(th_cells)&gt;0 :
            table_header_dict = self.get_table_header_dict(th_cells)
    #解析tr内的td,解析表格数据
    trs = soup.findAll("tr");
    td_dict_data = self.parse_tddata_to_dict(table_header_dict,trs)        
</pre></table></code></div></div><h1 id="获取tr内的th得到表头信息">获取tr内的th,得到表头信息</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>#获取表头信息
def get_table_header_dict(self,th_cells):
    th_count = len(th_cells)
    #print th_count
    th_dict={}
    index =0
    for i in range(th_count):
        temp = th_cells[i].text
        if ((temp =='参数')|(temp =='参数名')|(temp =='参数名称')|(temp =='名称')|(temp =='字段')|(temp =='字段名')|(temp='字段名称')):
            th_dict[i]= 'name'
        elif ('类型' in temp ):
            th_dict[i]= 'type'   
        elif ((temp=='说明')|(temp=='备注')|(temp='参数说明')|(temp='字段说明')):
            th_dict[i]= 'desc'
        else :
            th_dict[i]= temp
    return th_dict
</pre></table></code></div></div><p>#解析tr内的td,解析表格数据</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>def parse_tddata_to_dict(self,table_header_dict,trs):
    ret_list = []
    retuslt = {}
    for row in trs:
            # 获取表格内的所有td
            cells = row.findAll("td")
            if len(cells)&gt;0 :
                index = 0
                for i in range(len(cells)):
                       #直接通过text得到文本内容
                        print cells[index].text
                        retuslt[table_header_dict.get(index)] = cells[index].text
                        index = index+1

                ret_list.append(retuslt)
    #print len(ret_list)
    #print ret_list
    return ret_list;
</pre></table></code></div></div><p>直接用PyQuery获取不到不知道为啥，</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>for item in response.doc('.confluenceTable').items():
for i in range(len(item('td'))):
        field_name = th_dict[i%len(th_dict)]
       # print i,th_count,th_dict[i%th_count]
       #这个 item('td')[i].text很多时候(内部有 &lt;span&gt;&lt;/span&gt;标签)获取不到数据
        if item('td')[i] is not None and item('td')[i].text is not None:

            index = i%len(th_dict);
            field_name = th_dict[index]
            if 'name' in field_name or 'type' in field_name or 'desc' in field_name:
                td_data[field_name]=item('td')[i].text.encode("utf-8")
        else:
            print th_dict[i%len(th_dict)] +' no data'
            if 'name' in field_name or 'type' in field_name or 'desc' in field_name:
                field_name = th_dict[i%len(th_dict)]
                td_data[field_name]='null'

        if i&gt;0 and i%len(th_dict) ==0:
            print td_data
            td_data_list.append(td_data)
            td_data = {}
            td_data['url'] =url
            td_data['title'] =title



    print td_data_list
</pre></table></code></div></div><p>用lxml.html应该也可以的</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>for item in response.doc('.confluenceTable').items():
    root = lxml.html.fromstring(item.html())
    print "th  header"
    header_data = root.xpath('//tr/th//text()')
    print '======================='
    print 'len(header_data):'
    print len(header_data)
    print "td data"
    td_data = root.xpath('//tr/td//text()')
    '''
    for row in root.xpath('//tr/td//text()'):
        print([i for i in row.itertext()])
    '''


    print 'len(td_data):'
    print len(td_data)
    print  '======================='
</pre></table></code></div></div><p>最后入库数据，大概是这个样子</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>*************************** 19. row ***************************
   fid: 3052
  furl: http://abc.xyz.com/pages/viewpage.action?pageId=24841569
ftitle: 【20180903】腾讯云-照片比对接口对接 - 风控业务需求 - Confluence
 fname: sourcePhotoType
 ftype: String
 fdesc: 比对源照片类型1：网纹照2：高清照
*************************** 20. row ***************************
   fid: 3053
  furl: http://abc.xyz.com/pages/viewpage.action?pageId=24841569
ftitle: 【20180903】腾讯云-照片比对接口对接 - 风控业务需求 - Confluence
 fname: sourcePhotoType
 ftype: String
 fdesc: 比对源照片类型1：网纹照2：高清照
20 rows in set (0.01 sec)
</pre></table></code></div></div><h1 id="获取嵌套table的数据">获取嵌套table的数据</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
</pre><td class="rouge-code"><pre>&lt;div class="table-wrap"&gt;
 &lt;table class="wrapped confluenceTable"&gt;
  &lt;colgroup&gt;
   &lt;col /&gt;
   &lt;col /&gt;
   &lt;col /&gt;
   &lt;col /&gt;
  &lt;/colgroup&gt;
  &lt;tbody&gt;
   &lt;tr&gt;
    &lt;th class="confluenceTh"&gt;序号&lt;/th&gt;
    &lt;th class="confluenceTh"&gt;服务&lt;/th&gt;
    &lt;th class="confluenceTh"&gt;说明&lt;/th&gt;
    &lt;th colspan="1" class="confluenceTh"&gt;服务类型&lt;/th&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;01&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;查询接口&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;征信中心封装查询接口给前端请求同盾H5链接&lt;/td&gt;
    &lt;td rowspan="2" class="confluenceTd"&gt;查询接口&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;02&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;查询接口&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;征信中心将拿到的H5链接返回给前端&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;03&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;接收同盾登陆成功的回调&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;&lt;br /&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;回调接口&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;04&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;接收同盾抓取原始数据成功的回调&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;p&gt;&lt;br /&gt;&lt;/p&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;回调接口&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;05&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;请求数据&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;主动请求同盾的接口获取数据&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;br /&gt;&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;06&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;数据逻辑&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;落mongo&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;br /&gt;&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;07&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;查询接口&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;封装查询接口供请求方获取taskid&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;查询接口&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;08&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;查询接口&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;封装查询接口供请求方获取运营商数据或中间状态&lt;/span&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;br /&gt;&lt;/td&gt;
   &lt;/tr&gt;
  &lt;/tbody&gt;
 &lt;/table&gt;
&lt;/div&gt;
&lt;div class="table-wrap"&gt;
 &lt;table class="wrapped confluenceTable"&gt;
  &lt;colgroup&gt;
   &lt;col style="width: 94.0px;" /&gt;
   &lt;col style="width: 77.0px;" /&gt;
   &lt;col style="width: 119.0px;" /&gt;
  &lt;/colgroup&gt;
  &lt;tbody&gt;
   &lt;tr&gt;
    &lt;td class="highlight-grey confluenceTd" data-highlight-colour="grey"&gt;&lt;p&gt;参数&lt;/p&gt;&lt;/td&gt;
    &lt;td class="highlight-grey confluenceTd" colspan="1" data-highlight-colour="grey"&gt;是否必传&lt;/td&gt;
    &lt;td class="highlight-grey confluenceTd" data-highlight-colour="grey"&gt;&lt;p&gt;含义&lt;/p&gt;&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;&lt;p&gt;appid&lt;/p&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;&lt;p&gt;业务线Spuid&lt;/p&gt;&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;&lt;p&gt;taskId&lt;/p&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;&lt;p&gt;任务id&lt;/p&gt;&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;transationId&lt;/span&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;span&gt;Y&lt;/span&gt;&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;&lt;p&gt;请求的唯一标识&lt;/p&gt;&lt;/td&gt;
   &lt;/tr&gt;
  &lt;/tbody&gt;
 &lt;/table&gt;
&lt;/div&gt;
&lt;h3 class="auto-cursor-target" id="id-【20180830】同盾运营商数据对接-回调通知"&gt;回调通知&lt;/h3&gt;
&lt;p&gt;我们可以截取用户提交成功、原始报告获取结果（成功、失败、超时），魔方报告（成功、失败）。&lt;/p&gt;

&lt;div class="table-wrap"&gt;
 &lt;table class="confluenceTable"&gt;
  &lt;colgroup&gt;
   &lt;col /&gt;
   &lt;col /&gt;
   &lt;col /&gt;
  &lt;/colgroup&gt;
  &lt;tbody&gt;
   &lt;tr&gt;
    &lt;th class="confluenceTh"&gt;字段名称&lt;/th&gt;
    &lt;th colspan="1" class="confluenceTh"&gt;&lt;span style="color: rgb(51,51,51);text-decoration: none;"&gt;类型&lt;/span&gt;&lt;/th&gt;
    &lt;th class="confluenceTh"&gt;&lt;span style="color: rgb(51,51,51);text-decoration: none;"&gt;字段说明&lt;/span&gt;&lt;/th&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;notify_event&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;String&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;通知事件&lt;/td&gt;
   &lt;/tr&gt;
   &lt;tr&gt;
    &lt;td class="confluenceTd"&gt;notify_type&lt;/td&gt;
    &lt;td colspan="1" class="confluenceTd"&gt;String&lt;/td&gt;
    &lt;td class="confluenceTd"&gt;&lt;p class="auto-cursor-target"&gt;通知类型&lt;/p&gt;
     &lt;div class="table-wrap"&gt;
      &lt;table class="confluenceTable"&gt;
       &lt;tbody&gt;
        &lt;tr&gt;
         &lt;th class="confluenceTh"&gt;参数&lt;/th&gt;
         &lt;th class="confluenceTh"&gt;说明&lt;/th&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
         &lt;td class="confluenceTd"&gt;ACQUIRE&lt;/td&gt;
         &lt;td class="confluenceTd"&gt;任务创建 CREATED、任务成功 SUCCESS、任务失败 FAILURE、&lt;br /&gt;任务超时 TIMEOUT&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
         &lt;td class="confluenceTd"&gt;REPORT&lt;/td&gt;
         &lt;td class="confluenceTd"&gt;生成成功 SUCCESS、生成失败 FAILURE&lt;/td&gt;
        &lt;/tr&gt;
       &lt;/tbody&gt;
      &lt;/table&gt;
     &lt;/div&gt;&lt;/td&gt;
   &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
        
</pre></table></code></div></div><p>这里第一个表不是规整的表，第二行少一列，只有三个td标签</p><p>可以看到有个td里还包含一个table,结构都差不多，直接用find_all()不管是table,tr还是td都会有问题</p><p>可以通过parent的parent来判断：内嵌的parent.parent应该是td标签</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>tables = b4s_body.find_all('table')
for table in tables:
    print  table 
    print   table.parent.parent.name =='td'
</pre></table></code></div></div><p>遍历tr，td,还需要校验下th,td的长度(注意查找的时候设置参数recursive=False，不查找内部的嵌套tr,td))。最后问题是如果没有th,或者th长度有问题。。。</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre>b4s_body = BeautifulSoup(response.doc.html())
tables = b4s_body.find_all('table')
for table in tables:
    #print  table 
    if table.parent.parent.name =='td':
        print 'skip table: '
        print table
        continue          

    table_childrens = table.children 
    for table_children in table_childrens:
        is_tbody = table_children.name =='tbody'
        if is_tbody:
            trs = table_children.children
            for tr in trs:
                ths = tr.find_all('th',recursive=False)
                tds = tr.find_all('td',recursive=False)
                if len(ths)&gt;0:
                    print 'len(ths)'
                    print len(ths)
                elif len(tds)&gt;0:
                    print 'len(tds)'
                    print len(tds)
                else:
                    print 'no trs tds'
        else:
            print 'no tbody:'
            print table_children
</pre></table></code></div></div><p>最终的code</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
</pre><td class="rouge-code"><pre>@config(priority=2)
def detail_page(self, response):
    # url,title,name,type,desc
    url = response.url
    title = response.doc.find('title').eq(0).text()
    #print type(response.doc)
    #print response.etree



    #print response.doc('table')
    header_array=[] 
    last_sql_data_list = []

    body = lxml.html.fromstring(response.doc('body').html())


    b4s_body = BeautifulSoup(response.doc.html())
    #print b4s_body

    #tbs = b4s_body.find_all("table", recursive=False)
    #print len(tbs)



    tables = b4s_body.find_all('table')
    last_sql_data_list = []
    for table in tables:
        #print  table 
        if table.parent.parent.name =='td':
            print 'skip table: '
            print table
            continue

        tb_thead = table.find('thead')
        th_dict ={}
        if tb_thead is not None:
            print 'tb_thead is not None'
            th_trs = tb_thead.children

            th_dict = self.get_header_dict(th_trs)
        else:
            print 'has no tag  thead: ',table
        table_childrens = table.children 
        for table_children in table_childrens:

            has_tbody = table_children.name =='tbody'
            #has_thread = table_children.name =='thead'
            if has_tbody :
                trs = table_children.children
                print 'start:',table_children.name
                print table_children

                print 'len(th_dict)',len(th_dict)

                if len(th_dict)&lt;=0:
                    print 'find'

                    th_dict = self.get_header_dict(trs)
                #重新获取下trs
                trs = table_children.children
                td_dict_data_list = self.get_table_td_dict(trs,th_dict)
                print type(td_dict_data_list)
                sql_list_data=self.generate_sql_list_data(td_dict_data_list,url,title)
                print sql_list_data
                last_sql_data_list = last_sql_data_list + sql_list_data
            else:
                print 'no tbody:'
                print table_children
        print 'last_sql_data_list#####'
        print last_sql_data_list

    return last_sql_data_list;   


'''
1,从th中提取出
2,如果没有th，则提取class_='highlight-grey confluenceTd'
3,1,2没有，则从普通td中的第一行提取

'''
def get_header_dict(self,trs):
    th_dict = {}
    th_dict_org = {}
    for tr in trs:
        th_count = 0
        print 'get_header_dict: ',tr
        ths = tr.find_all('th',recursive=False)
        for th in ths:
            print th
        th_count =  len(list(ths))
        print th_count
        if th_count&lt;=0:
            ths = tr.find_all('td',class_='highlight-grey confluenceTd',recursive=False)
            th_count =  len(list(ths))
            print 'find highlight-grey confluenceTd: ',th_count
        if th_count&lt;=0:
            tds = tr.find_all('td',recursive=False)
            name = tds[0].text
            print 'name;:::::::::: ',name,len(tds)
            if name is not None and tds[0].text=='参数名':
                for i in range(len(tds)):
                    temp = tds[i].text
                    if ((temp =='参数')|(temp =='参数名')|(temp =='参数名称')|(temp =='名称')|(temp =='字段')|(temp =='字段名')|(temp=='字段名称')|(temp=='Field')):
                        if ('name' in  th_dict.values()):
                            th_dict[i]= temp
                        else:
                            th_dict[i]= 'name'
                    elif (('类型' ==temp)|(temp=='字段格式')|(temp=='参数类型')|(temp=='字段类型')|(temp=='Type')):
                        if ('type' in  th_dict.values()):
                            th_dict[i]= temp
                        else:
                            th_dict[i]= 'type'   
                    elif ((temp=='中文含义')|(temp=='含义')|(temp=='说明')|(temp=='备注')|(temp=='参数说明')|(temp=='字段说明')|(temp=='描述')|(temp=='字段描述')|(temp=='Comment')):
                        if ('desc' in th_dict.values()):
                            th_dict[i]= temp
                        else:
                            th_dict[i]= 'desc'
                    else :
                        th_dict[i]= temp
            print "from td, th_dict: "+json.dumps(th_dict, encoding="UTF-8", ensure_ascii=False)
            return th_dict



        if th_count &gt;0:
            for i in range(th_count):
                print i
                temp = ths[i].text
                th_dict_org[i] =  temp
                print 'temp###### ',temp
                if ((temp =='参数')|(temp =='参数名')|(temp =='参数名称')|(temp =='名称')|(temp =='字段')|(temp =='字段名')|(temp=='字段名称')|(temp=='Field')):

                    if ('name' in  th_dict.values()):
                        th_dict[i]= temp
                    else:
                        th_dict[i]= 'name'
                elif (('类型' ==temp)|(temp=='字段格式')|(temp=='参数类型')|(temp=='字段类型')|(temp=='Type')):
                    if ('type' in  th_dict.values()):
                        th_dict[i]= temp
                    else:
                        th_dict[i]= 'type'   
                elif ((temp=='中文含义')|(temp=='含义')|(temp=='说明')|(temp=='备注')|(temp=='参数说明')|(temp=='字段说明')|(temp=='描述')|(temp=='字段描述')|(temp=='Comment')):
                    if ('desc' in th_dict.values()):
                        th_dict[i]= temp
                    else:
                        th_dict[i]= 'desc'
                else :
                    th_dict[i]= temp
        if th_count &lt;=0:
            print 'no th_dict'
            print 'skip this tr',tr
        if th_count&gt;0:
            break;
    print "th_dict: "+json.dumps(th_dict, encoding="UTF-8", ensure_ascii=False)
    print "th_dict_org: "+json.dumps(th_dict_org, encoding="UTF-8", ensure_ascii=False)
    return th_dict;

def get_table_td_dict(self,trs,th_dict):
    th_count = len(th_dict)

    td_dict_list = []
    for tr in trs:
        result = {}
        tds = tr.find_all('td',recursive=False)
        tr_children = tr.children
        td_count = len(tds)
        tr_children_count = len(list(tr_children))
        #比较下表头的长度作为校验
        if th_count &lt;=0 or td_count !=th_count:
            print 'skip a tr',th_count,td_count
            print tr
            continue
        else:
            #print tr
            for i in range(td_count):
                td_text = tds[i].text
                result[th_dict.get(i)] =  td_text
                if td_text is None:
                    print 'tds[i]: ',tds[i]
                    result[th_dict.get(i)] = 'null'

        td_dict_list.append(result)
        print "result: "+json.dumps(result, encoding="UTF-8", ensure_ascii=False)
    print len(td_dict_list)
    return td_dict_list

def generate_sql_list_data(self,td_dict_data,url,title):
    resultlist = []
    for td_data_item in td_dict_data:
            
            templist= []
            #print len(td_data_item)
            templist.append(url)
            templist.append(title)
            fname = td_data_item.get('name')
            if fname is None :
                print "skip generate_sql_list_data: "+ json.dumps(td_data_item, encoding="UTF-8", ensure_ascii=False)
                continue
            templist.append(fname)
            ftype = td_data_item.get('type')
            if ftype is None :
                templist.append("null")
            else:
                 templist.append(ftype)
                    
            fdesc = td_data_item.get('desc')
            if fdesc is None :
                templist.append("null")
            else:
                 templist.append(fdesc)
            #print len(templist)  
            print 'llllllllllllllll'
            print '\n'.join(templist)
            resultlist.append(templist)
        #print "resultlist: "
        #print len(resultlist)
        #print  resultlist
        return resultlist
            
    def on_result(self,result):
        self.mysqlStore.insert(result)	
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/python/'>python</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=pyspider%E7%88%AC%E5%8F%96%E5%B9%B6%E8%A7%A3%E6%9E%90%E7%BD%91%E9%A1%B5%E4%B8%ADtable%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BE%8B%E5%AD%90+-+Chirpy&url=%2Fposts%2Fpyspider_table%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=pyspider%E7%88%AC%E5%8F%96%E5%B9%B6%E8%A7%A3%E6%9E%90%E7%BD%91%E9%A1%B5%E4%B8%ADtable%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BE%8B%E5%AD%90+-+Chirpy&u=%2Fposts%2Fpyspider_table%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fpyspider_table%2F&text=pyspider%E7%88%AC%E5%8F%96%E5%B9%B6%E8%A7%A3%E6%9E%90%E7%BD%91%E9%A1%B5%E4%B8%ADtable%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BE%8B%E5%AD%90+-+Chirpy" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/distributed/">distributed</a> <a class="post-tag" href="/tags/datascience/">Datascience</a> <a class="post-tag" href="/tags/ml/">ML</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/realtime/">realtime</a> <a class="post-tag" href="/tags/flink/">flink</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/streamsets/">streamsets</a> <a class="post-tag" href="/tags/search/">Search</a> <a class="post-tag" href="/tags/file/">File</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Python-Notes/"><div class="card-body"> <em class="small" data-ts="1434240000" data-df="ll" > Jun 14, 2015 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python Notes</h3><div class="text-muted small"><p> python列表类型extend()与append() append() 只追加得到额外的一个元素,可以认为是tuple，extend()只能是一个列表 &amp;gt;&amp;gt;&amp;gt; a=[1,2] &amp;gt;&amp;gt;&amp;gt; b=[3,5] &amp;gt;&amp;gt;&amp;gt; c=[3,5] &amp;gt;&amp;gt;&amp;gt; b.append(a) &amp;gt;&amp;gt;&amp;gt; c.extend(a) &amp;gt;&amp;...</p></div></div></a></div><div class="card"> <a href="/posts/pyspider_douban/"><div class="card-body"> <em class="small" data-ts="1537315200" data-df="ll" > Sep 19, 2018 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>pyspider爬取豆瓣电影</h3><div class="text-muted small"><p> 安装 略 pip install pyspider 使用mysql替换SQLite $ cat mysql.json { &quot;taskdb&quot;: &quot;mysql+taskdb://canal:canal@172.28.3.159:3306/pyspider&quot;, &quot;projectdb&quot;: &quot;mysql+projectdb://canal:canal@172.28.3.159:3306...</p></div></div></a></div><div class="card"> <a href="/posts/python_Iterator_Iterable/"><div class="card-body"> <em class="small" data-ts="1538092800" data-df="ll" > Sep 28, 2018 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python Iterator TypeError: object of type 'listiterator' has no len()</h3><div class="text-muted small"><p> 在计算的len的时候碰到 1 TypeError: object of type &#39;listiterator&#39; has no len() 说明这个对象是个iterator，是没有len的，翻了下google 普遍的做法是使用len(list(iterator)) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 &amp;gt...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pyspider_douban/" class="btn btn-outline-primary" prompt="Older"><p>pyspider爬取豆瓣电影</p></a> <a href="/posts/python_Iterator_Iterable/" class="btn btn-outline-primary" prompt="Newer"><p>Python Iterator TypeError: object of type 'listiterator' has no len()</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">your_full_name</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/distributed/">distributed</a> <a class="post-tag" href="/tags/datascience/">Datascience</a> <a class="post-tag" href="/tags/ml/">ML</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/realtime/">realtime</a> <a class="post-tag" href="/tags/flink/">flink</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/streamsets/">streamsets</a> <a class="post-tag" href="/tags/search/">Search</a> <a class="post-tag" href="/tags/file/">File</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
